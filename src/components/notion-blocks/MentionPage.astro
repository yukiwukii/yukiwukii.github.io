---
import { Post } from "../../lib/interfaces.ts";
import { getPostByPageId } from "../../lib/notion/client";
import { getPostLink } from "../../lib/blog-helpers.ts";
import { MENU_PAGES_COLLECTION, REFERENCES } from "@/constants";
import { textToAstroIcon, generateIconTailwindFilterStyle, isNotionIconURL } from "@/lib/style-helpers";
import { Icon } from "astro-iconify";
// import { rootHasDarkClass } from "@/utils";

export interface Props {
	pageId: string;
}

const { pageId } = Astro.props;

let post: Post = null;
if (pageId) {
	post = await getPostByPageId(pageId);
}
// let iconURL = post.Icon && post.Icon.Type === "external" && isNotionIconURL(post.Icon.Url)?post.Icon.Url:null;
//does not work because that needs to be in client side script
// if (rootHasDarkClass() && iconURL){iconURL = post.Icon.Url+"?mode=dark";}

const hreflink=post?getPostLink(post.Slug, post.Collection === MENU_PAGES_COLLECTION):null;
---

{    post && (
        <a href={hreflink} class="inline items-center justify-center underline decoration-wavy decoration-accent-2/20 p-0.5 font-medium hover:decoration-accent/40">
            <>
				<span class="mx-1 inline">
					{post.Icon && post.Icon.Type === "emoji" ? (
						post.Icon.Emoji
					) : post.Icon && post.Icon.Type === "external" ? (
						<img src={post.Icon.Url} class={`h-4 w-4 flex-shrink-0 align-sub inline ${generateIconTailwindFilterStyle(post.Icon.Url)}`} />
					) : textToAstroIcon("document") ? (
						<Icon name={textToAstroIcon("document")} class="inline h-4 w-4" />
					) : (
						"ðŸ“„"
					)}
				</span>
				<span class="w-full inline">{post.Title}</span>

				{textToAstroIcon("page-mention-ne-arrow") ? (
					<Icon name={textToAstroIcon("page-mention-ne-arrow")} class="inline h-4 w-4" />
				) : (
					<svg
						class="h-4 w-4"
						aria-hidden="true"
						xmlns="http://www.w3.org/2000/svg"
						fill="none"
						viewBox="0 0 14 10"
					>
						<path
							stroke="currentColor"
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="M1 5h12m0 0L9 1m4 4L9 9"
						/>
					</svg>
				)}
			</>

        </a>
    )
}

