---
import Icon from "@/components/ui/Icon.astro";

interface Props {
	excerpt?: string;
	linkedTo: string;
	popoverSpanText: string;
	popoverTitle: string;
	postId: string;
	linkText?: string;
}
const {
	excerpt = "",
	linkedTo,
	popoverSpanText,
	popoverTitle,
	postId,
	linkText = "Read more",
} = Astro.props;
let id = "id" + Math.random().toString(16).slice(2) + "---" + postId;
---

<span class="site-page-link text-link">
	<span
		data-popover-target={`popover-description-${id}`}
		data-popover-placement="bottom-end"
		class="cursor-pointer"
		data-href={linkedTo}
		id={`popover-click-${id}`}
		aria-label="Show information for the linked content"
	>
		{popoverSpanText ? popoverSpanText : <slot />}
	</span>
</span>

<template id={`template-popover-description-${id}`}>
	<div
		data-popover
		id={`popover-description-${id}`}
		role="tooltip"
		class="popoverEl border-accent-2/20 bg-popover-bg/95 text-textColor/80 invisible absolute z-40 hidden inline-block w-72 rounded-lg border text-sm opacity-0 shadow-xs backdrop-blur-sm transition-opacity duration-300"
	>
		<a href={linkedTo}>
			<div class="space-y-2 p-3">
				<h3 class="text-accent decoration-accent-2/20 font-semibold underline decoration-wavy">
					{popoverTitle}
				</h3>
				{excerpt && <p>{excerpt}</p>}
				<a
					href={linkedTo}
					data-popover-link
					class="text-link/90 flex max-w-full items-center font-medium hover:underline"
				>
					{linkText}
					<Icon
						class="ms-1.5 h-3 w-3 rtl:rotate-180"
						name={"jump"}
						aria-hidden="true"
						focusable="false"
					/>
				</a>
			</div>
		</a>
		<div data-popper-arrow></div>
	</div>
</template>
